---
layout:     post
title:      Git操作记录
subtitle:   
date:       2023-09-12
author:     forwardZ
header-img: img/the-first.png
catalog: false
tags:
    - 浏览器_工程化_Git
---



### Git操作之回滚

#### 背景描述

小程序个人开发分支由于merge了其他的分支，担心集成过程导致冲突（他人的开发分支不断在更新，没有及时更新，极易产生冲突），想回退至merge其他分支之前

#### 操作记录

```bash
// 先查看提交记录，确认回退到的 commit id（不需要写全）
git log
// 1，为merge 时的提交
// 2，为回退的 commit id
```

<img src="/Users/zhongdaxing1/Library/Application Support/typora-user-images/image-20230912171005861.png" alt="image-20230912171005861" style="zoom:35%;" />

[git-log-1.png](https://postimg.cc/MMnn98zp)



```bash
// 注：这里只是本地回退，通过 git status 可以看到本地分支落后远程分支
git reset --hard c17223f
// 由于推至了远程，远程分支也需处理，即强制推送到远程分支
git push -f origin feature_farm_game_10.10
```

![image-20230912171457615](/Users/zhongdaxing1/Library/Application Support/typora-user-images/image-20230912171457615.png)

[git-reset-1.png](https://postimg.cc/sv4g925J)

<img src="/Users/zhongdaxing1/Library/Application Support/typora-user-images/image-20230912171557344.png" alt="image-20230912171557344" style="zoom:80%;" />

[git-push-force.png](https://postimg.cc/zbzsNJyq)

注：**本地分支回滚后，版本将落后远程分支，必须使用强制推送覆盖远程分支，否则无法推送到远程分支**





### Git之常规操作

```bash
// 克隆指定的分支
git clone -b xxx-分支名 xxx-地址
// git clone -b develop xxx-地址
// 新建分支 xxx
git branch xxx
// 如：git branch feature-zhongdaxing1
git branch // 查看本地的分支
git checkout feature-zhongdaxing1
// 关联本地分支与远程
git push -u origin xxx
// 查看目前的状态
git status
// 暂存为提交的修改
git stash
// 恢复通过 stash 暂存的修改
git stash pop
```

#### 新建本地分支

```bash
git clone -b develop xxx-地址 // 克隆分支
git branch feature-zhongdaxing1 // 新建分支
git branch // 查看分支，确认是否新建完成
git checkout feature-zhongdaxing1 // 切换到本地自己的开发分支
```

#### 初次提交

```bash
git branch // 确定当前所在分支
git add . // 推至暂存区
git commit -m '说明：feat/fix/'
git push -u origin feature-zhongdaxing1 // 注意用u关联本地和远程
```

#### 开发未完成时，同事提交并合并

开发未完成时，同时提交并合并到开发分支develop上，需拉下相关代码

```bash
git status // 查看目前的状态,所在分支，哪些修改
git stash // 暂存目前修改
git checkout develop // 切换到共同开发分支 develop
git pull develop // 拉取同事提交的代码，更新本地develop
git checkout feature-zhongdaxing1 // 切换回本地个人开发分支
git merge develop // 合并develop的更新,可能需要解决冲突
git stash pop // 恢复stash的改动
```

注：最终开发完成，合并请求时，源分支为feature-zhongdaxing1 ，目标分支为develop，



#### 开发过程提交，建议先拉再推，减少冲突

##### 关于提交出现冲突

1. 复原冲突解决的过程

```bash
git branch
git add .
git commit -m 'feat: 任务模块'
git push
// 在线上合并的时候，出现冲突，取消合并请求，准备本地解决冲突
git branch
git checkout develop
git pull
git checkout feature-zhongdaxing1
git merge develop // 该命令执行后，必然产生冲突
// 解决冲突：做一些取舍，保留那些，删去哪些，保存代码
git add .
git commit -m 'fix: 解决冲突'
git push // 此时，在线上提交合并申请，就出现「可以自动合并」的提示，不会出现冲突
```

2. 总结更好的实践

先拉后推

```bash
git stash
git checkout develop
git pull
git checkout feature-zhongdaxing1
git stash pop
git merge develop // 处理冲突
git add .
git commit -m ''
git push // 提交后，线上请求合并
```



